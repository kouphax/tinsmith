(function(e){function t(e){this.options=a.extend({},t.defaultOptions,e),this.data=[],this.maxValue=Number.NaN,this.minValue=Number.NaN}function i(e){this.options=a.extend({},i.defaultChartOptions,e),this.seriesSet=[],this.currentValueRange=1,this.currentVisMinValue=0}var a={extend:function(){arguments[0]=arguments[0]||{};for(var e=1;arguments.length>e;e++)for(var t in arguments[e])arguments[e].hasOwnProperty(t)&&(arguments[0][t]="object"==typeof arguments[e][t]?arguments[e][t]instanceof Array?arguments[e][t]:a.extend(arguments[0][t],arguments[e][t]):arguments[e][t]);return arguments[0]}};t.defaultOptions={resetBoundsInterval:3e3,resetBounds:!0},t.prototype.resetBounds=function(){if(this.data.length){this.maxValue=this.data[0][1],this.minValue=this.data[0][1];for(var e=1;this.data.length>e;e++){var t=this.data[e][1];t>this.maxValue&&(this.maxValue=t),this.minValue>t&&(this.minValue=t)}}else this.maxValue=Number.NaN,this.minValue=Number.NaN},t.prototype.append=function(e,t,i){for(var a=this.data.length-1;a>0&&this.data[a][0]>e;)a--;this.data.length>0&&this.data[a][0]===e?i?(this.data[a][1]+=t,t=this.data[a][1]):this.data[a][1]=t:this.data.length-1>a?this.data.splice(a+1,0,[e,t]):this.data.push([e,t]),this.maxValue=isNaN(this.maxValue)?t:Math.max(this.maxValue,t),this.minValue=isNaN(this.minValue)?t:Math.min(this.minValue,t)},t.prototype.dropOldData=function(e,t){for(var i=0;this.data.length-i>=t&&e>this.data[i+1][0];)i++;0!==i&&this.data.splice(0,i)},i.defaultChartOptions={millisPerPixel:20,maxValueScale:1,interpolation:"bezier",scaleSmoothing:.125,maxDataSetLength:2,grid:{fillStyle:"#000000",strokeStyle:"#777777",lineWidth:1,sharpLines:!1,millisPerLine:1e3,verticalSections:2,borderVisible:!0},labels:{fillStyle:"#ffffff",disabled:!1,fontSize:10,fontFamily:"monospace",precision:2},horizontalLines:[]},i.AnimateCompatibility=function(){var e=0,t=function(t,i){var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){var i=(new Date).getTime(),a=Math.max(0,16-(i-e)),n=window.setTimeout(function(){t(i+a)},a);return e=i+a,n};return a.call(window,t,i)},i=function(e){var t=window.cancelAnimationFrame||function(e){clearTimeout(e)};return t.call(window,e)};return{requestAnimationFrame:t,cancelAnimationFrame:i}}(),i.defaultSeriesPresentationOptions={lineWidth:1,strokeStyle:"#ffffff"},i.prototype.addTimeSeries=function(e,t){this.seriesSet.push({timeSeries:e,options:a.extend({},i.defaultSeriesPresentationOptions,t)}),e.options.resetBounds&&e.options.resetBoundsInterval>0&&(e.resetBoundsTimerId=setInterval(function(){e.resetBounds()},e.options.resetBoundsInterval))},i.prototype.removeTimeSeries=function(e){for(var t=this.seriesSet.length,i=0;t>i;i++)if(this.seriesSet[i].timeSeries===e){this.seriesSet.splice(i,1);break}e.resetBoundsTimerId&&clearInterval(e.resetBoundsTimerId)},i.prototype.streamTo=function(e,t){this.canvas=e,this.delay=t,this.start()},i.prototype.start=function(){if(!this.frame){var e=function(){this.frame=i.AnimateCompatibility.requestAnimationFrame(function(){this.render(),e()}.bind(this))}.bind(this);e()}},i.prototype.stop=function(){this.frame&&(i.AnimateCompatibility.cancelAnimationFrame(this.frame),delete this.frame)},i.prototype.updateValueRange=function(){for(var e=this.options,t=Number.NaN,i=Number.NaN,a=0;this.seriesSet.length>a;a++){var n=this.seriesSet[a].timeSeries;isNaN(n.maxValue)||(t=isNaN(t)?n.maxValue:Math.max(t,n.maxValue)),isNaN(n.minValue)||(i=isNaN(i)?n.minValue:Math.min(i,n.minValue))}if(null!=e.maxValue?t=e.maxValue:t*=e.maxValueScale,null!=e.minValue&&(i=e.minValue),this.options.yRangeFunction){var s=this.options.yRangeFunction({min:i,max:t});i=s.min,t=s.max}if(!isNaN(t)&&!isNaN(i)){var r=t-i;this.currentValueRange+=e.scaleSmoothing*(r-this.currentValueRange),this.currentVisMinValue+=e.scaleSmoothing*(i-this.currentVisMinValue)}this.valueRange={min:i,max:t}},i.prototype.render=function(e,t){e=e||this.canvas,t=t||(new Date).getTime()-(this.delay||0),t-=t%this.options.millisPerPixel;var i=e.getContext("2d"),a=this.options,n={top:0,left:0,width:e.clientWidth,height:e.clientHeight},s=t-n.width*a.millisPerPixel,r=function(e){var t=e-this.currentVisMinValue;return 0===this.currentValueRange?n.height:n.height-Math.round(t/this.currentValueRange*n.height)}.bind(this),l=function(e){return Math.round(n.width-(t-e)/a.millisPerPixel)};if(this.updateValueRange(),i.font=a.labels.fontSize+"px "+a.labels.fontFamily,i.save(),i.translate(n.left,n.top),i.beginPath(),i.rect(0,0,n.width,n.height),i.clip(),i.save(),i.fillStyle=a.grid.fillStyle,i.clearRect(0,0,n.width,n.height),i.fillRect(0,0,n.width,n.height),i.restore(),i.save(),i.lineWidth=a.grid.lineWidth,i.strokeStyle=a.grid.strokeStyle,a.grid.millisPerLine>0)for(var o=n.width-i.measureText(M).width+4,h=t-t%a.grid.millisPerLine;h>=s;h-=a.grid.millisPerLine){var u=l(h);if(a.grid.sharpLines&&(u-=.5),i.beginPath(),i.moveTo(u,0),i.lineTo(u,n.height),i.stroke(),i.closePath(),a.timestampFormatter&&o>u){var m=new Date(h),d=a.timestampFormatter(m),f=i.measureText(d).width;o=u-f-2,i.fillStyle=a.labels.fillStyle,i.fillText(d,u-f,n.height-2)}}for(var c=1;a.grid.verticalSections>c;c++){var g=Math.round(c*n.height/a.grid.verticalSections);a.grid.sharpLines&&(g-=.5),i.beginPath(),i.moveTo(0,g),i.lineTo(n.width,g),i.stroke(),i.closePath()}if(a.grid.borderVisible&&(i.beginPath(),i.strokeRect(0,0,n.width,n.height),i.closePath()),i.restore(),a.horizontalLines&&a.horizontalLines.length)for(var p=0;a.horizontalLines.length>p;p++){var v=a.horizontalLines[p],S=Math.round(r(v.value))-.5;i.strokeStyle=v.color||"#ffffff",i.lineWidth=v.lineWidth||1,i.beginPath(),i.moveTo(0,S),i.lineTo(n.width,S),i.stroke(),i.closePath()}for(var x=0;this.seriesSet.length>x;x++){i.save();var V=this.seriesSet[x].timeSeries,y=V.data,w=this.seriesSet[x].options;V.dropOldData(s,a.maxDataSetLength),i.lineWidth=w.lineWidth,i.strokeStyle=w.strokeStyle,i.beginPath();for(var b=0,N=0,T=0,P=0;y.length>P&&1!==y.length;P++){var F=l(y[P][0]),R=r(y[P][1]);if(0===P)b=F,i.moveTo(F,R);else switch(a.interpolation){case"linear":case"line":i.lineTo(F,R);break;case"bezier":default:i.bezierCurveTo(Math.round((N+F)/2),T,Math.round(N+F)/2,R,F,R)}N=F,T=R}y.length>1&&(w.fillStyle&&(i.lineTo(n.width+w.lineWidth+1,T),i.lineTo(n.width+w.lineWidth+1,n.height+w.lineWidth+1),i.lineTo(b,n.height+w.lineWidth),i.fillStyle=w.fillStyle,i.fill()),w.strokeStyle&&"none"!==w.strokeStyle&&i.stroke(),i.closePath()),i.restore()}if(!a.labels.disabled&&!isNaN(this.valueRange.min)&&!isNaN(this.valueRange.max)){var k=parseFloat(this.valueRange.max).toFixed(a.labels.precision),M=parseFloat(this.valueRange.min).toFixed(a.labels.precision);i.fillStyle=a.labels.fillStyle,i.fillText(k,n.width-i.measureText(k).width-2,a.labels.fontSize),i.fillText(M,n.width-i.measureText(M).width-2,n.height-2)}i.restore()},i.timeFormatter=function(e){function t(e){return(10>e?"0":"")+e}return t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())},e.TimeSeries=t,e.SmoothieChart=i})("undefined"==typeof exports?this:exports);